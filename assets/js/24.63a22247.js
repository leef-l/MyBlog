(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{503:function(t,a,s){"use strict";s.r(a);var e=s(41),r=Object(e.a)({},(function(){var t=this,a=t.$createElement,s=t._self._c||a;return s("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[t._v("Dockerfile详解")])]),t._v(" "),s("p",[s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#%E7%8E%AF%E5%A2%83%E4%BB%8B%E7%BB%8D"}},[t._v("环境介绍")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#%E6%8C%87%E4%BB%A4%E4%BB%8B%E7%BB%8D"}},[t._v("指令介绍")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#FROM"}},[t._v("FROM")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#MAINTAINER"}},[t._v("MAINTAINER")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#FROM"}},[t._v("LABEL")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#ADD"}},[t._v("ADD")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#COPY"}},[t._v("COPY")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#EXPOSE"}},[t._v("EXPOSE")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#ENV"}},[t._v("ENV")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#%E5%9C%A8Dockerfile%E4%B8%AD%E4%BD%BF%E7%94%A8%E5%8F%98%E9%87%8F%E7%9A%84%E6%96%B9%E5%BC%8F"}},[t._v("在 Dockerfile 中使用变量的方式")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#RUN"}},[t._v("RUN")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#CMD"}},[t._v("CMD")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#RUN&&CMD"}},[t._v("RUN&&CMD")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#ENTRYPOINT"}},[t._v("ENTRYPOINT")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#VOLUME"}},[t._v("VOLUME")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#USER"}},[t._v("USER")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#WORKDIR"}},[t._v("WORKDIR")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#ARG"}},[t._v("ARG")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#ONBUILD"}},[t._v("ONBUILD")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#STOPSIGNAL"}},[t._v("STOPSIGNAL")]),s("br"),t._v(" "),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),s("mjx-container",{staticClass:"MathJax",staticStyle:{direction:"ltr"},attrs:{jax:"SVG"}},[s("svg",{staticStyle:{overflow:"visible","min-height":"1px","min-width":"1px","vertical-align":"0"},attrs:{xmlns:"http://www.w3.org/2000/svg",width:"4.525ex",height:"0.036ex",role:"img",focusable:"false",viewBox:"0 0 2000 16"}},[s("g",{attrs:{stroke:"currentColor",fill:"currentColor","stroke-width":"0",transform:"scale(1,-1)"}},[s("g",{attrs:{"data-mml-node":"math"}},[s("g",{attrs:{"data-mml-node":"mstyle"}},[s("g",{attrs:{"data-mml-node":"mspace"}})])])])])]),t._v(" "),s("a",{attrs:{href:"#HEALTHCHECK"}},[t._v("HEALTHCHECK")])],1),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[s("a",{attrs:{id:"环境介绍"}},[t._v("环境介绍")])])]),t._v(" "),s("p",[t._v("1.Dockerfile 中所用的所有文件一定要和 Dockerfile 文件在同一级父目录下，可以为 Dockerfile 父目录的子目录"),s("br"),t._v("\n 2.Dockerfile 中相对路径默认都是 Dockerfile 所在的目录"),s("br"),t._v("\n 3.Dockerfile 中一定要惜字如金，能写到一行的指令，一定要写到一行，原因是分层构建，联合挂载这个特性。"),s("br"),t._v("\nDockerfile 中每一条指令被视为一层"),s("br"),t._v("\n 4.Dockerfile 中指明大写（约定俗成）")]),t._v(" "),s("div",{staticClass:"custom-block tip"},[s("p",{staticClass:"custom-block-title"},[s("a",{attrs:{id:"指令介绍"}},[t._v("指令介绍")])])]),t._v(" "),s("p",[s("a",{attrs:{id:"FROM"}},[t._v("FROM")]),s("br"),t._v("\n功能为指定基础镜像，并且必须是第一条指令。")]),t._v(" "),s("p",[t._v("如果不以任何镜像为基础，那么写法为：FROM scratch。")]),t._v(" "),s("p",[t._v("同时意味着接下来所写的指令将作为镜像的第一层开始"),s("br"),t._v("\n语法：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("FROM "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("image"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nFROM "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("image"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("tag"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nFROM "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("image"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(":"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("digest"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" \n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#三种写法，其中<tag>和<digest> 是可选项，如果没有选择，那么默认值为latest")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br")])]),s("p",[s("a",{attrs:{id:"MAINTAINER"}},[t._v("MAINTAINER")]),s("br"),t._v("\n指定作者")]),t._v(" "),s("p",[t._v("语法：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("MAINTAINER "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ul",[s("li",[t._v("新版 docker 中使用 LABEL 指明")])]),t._v(" "),s("p",[s("a",{attrs:{id:"LABEL"}},[t._v("LABEL")])]),t._v(" "),s("p",[t._v("功能是为镜像指定标签")]),t._v(" "),s("p",[t._v("语法：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("LABEL "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#一个Dockerfile种可以有多个LABEL，如下：")]),t._v("\n\nLABEL "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"com.example.vendor"')]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"ACME Incorporated"')]),t._v("\nLABEL com.example.label-with-value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"foo"')]),t._v("\nLABEL "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("version")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"1.0"')]),t._v("\nLABEL "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("description")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"This text illustrates \\\nthat label-values can span multiple lines."')]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#但是并不建议这样写，最好就写成一行，如太长需要换行的话则使用\\符号")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#如下：")]),t._v("\n\nLABEL multi.label1"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value1"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nmulti.label2"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value2"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("other")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"value3"')]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br"),s("span",{staticClass:"line-number"},[t._v("10")]),s("br"),s("span",{staticClass:"line-number"},[t._v("11")]),s("br"),s("span",{staticClass:"line-number"},[t._v("12")]),s("br"),s("span",{staticClass:"line-number"},[t._v("13")]),s("br"),s("span",{staticClass:"line-number"},[t._v("14")]),s("br"),s("span",{staticClass:"line-number"},[t._v("15")]),s("br"),s("span",{staticClass:"line-number"},[t._v("16")]),s("br")])]),s("p",[t._v("说明：LABEL 会继承基础镜像种的 LABEL，如遇到 key 相同，则值覆盖")]),t._v(" "),s("p",[s("a",{attrs:{id:"ADD"}},[t._v("ADD")]),s("br"),t._v("\n一个复制命令，把文件复制到镜像中。"),s("br"),t._v("\n如果把虚拟机与容器想象成两台 linux 服务器的话，那么这个命令就类似于 scp，只是 scp 需要加用户名和密码的权限验证，而 ADD 不用。"),s("br"),t._v("\n语法如下：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(". ADD "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("dest"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(". ADD "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<src>"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<dest>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("ul",[s("li",[t._v("路径的填写可以是容器内的绝对路径，也可以是相对于工作目录的相对路径，推荐写成绝对路径")]),t._v(" "),s("li"),t._v(" "),s("li",[t._v("可以是一个本地文件或者是一个本地压缩文件，还可以是一个 url")]),t._v(" "),s("li"),t._v(" "),s("li",[t._v("如果把写成一个 url，那么 ADD 就类似于 wget 命令")]),t._v(" "),s("li",[t._v("示例")])]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("ADD "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v(" relativeDir/ \nADD "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("test")]),t._v(" /relativeDir\nADD http://example.com/foobar /\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("注意事项")]),t._v(" "),s("ul",[s("li",[t._v("src 为一个目录的时候，会自动把目录下的文件复制过去，目录本身不会复制")]),t._v(" "),s("li",[t._v("如果 src 为多个文件，dest 一定要是一个目录")])]),t._v(" "),s("p",[s("a",{attrs:{id:"COPY"}},[t._v("COPY")]),s("br"),t._v("\n看这个名字就知道，又是一个复制命令")]),t._v(" "),s("p",[t._v("语法如下：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("COPY "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("src"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("dest"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nCOPY "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<src>"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(". "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"<dest>"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("与 ADD 的区别")]),t._v(" "),s("ul",[s("li",[t._v("COPY 的只能是本地文件，其他用法一致")])]),t._v(" "),s("p",[s("a",{attrs:{id:"EXPOSE"}},[t._v("EXPOSE")])]),t._v(" "),s("p",[t._v("EXPOSE")]),t._v(" "),s("p",[t._v("功能为暴漏容器运行时的监听端口给外部")]),t._v(" "),s("p",[t._v("但是 EXPOSE 并不会使容器访问主机的端口")]),t._v(" "),s("p",[t._v("如果想使得容器与主机的端口有映射关系，必须在容器启动的时候加上 -P 参数"),s("br"),t._v("\n语法：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("EXPOSE "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("port"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("/"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("tcp/udp"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[s("a",{attrs:{id:"ENV"}},[t._v("ENV")]),s("br"),t._v("\n功能为设置环境变量")]),t._v(" "),s("p",[t._v("语法有两种")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("ENV "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\nENV "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("key"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("..")]),t._v(".\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[s("a",{attrs:{id:"在Dockerfile中使用变量的方式"}},[t._v("在 Dockerfile 中使用变量的方式")])]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$varname")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${varname}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("${varname"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":-")]),t._v("default value}")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("$(")]),t._v("varname:+default value"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("第一种和第二种相同"),s("br"),t._v("\n第三种表示当变量不存在使用 - 号后面的值"),s("br"),t._v("\n第四种表示当变量存在时使用 + 号后面的值（当然不存在也是使用后面的值）")]),t._v(" "),s("p",[s("a",{attrs:{id:"RUN"}},[t._v("RUN")]),s("br"),t._v("\n功能为运行指定的命令"),s("br"),t._v("\n RUN 命令有两种格式")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(". RUN "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("command"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(". RUN "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"executable"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param1"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("第一种后边直接跟 shell 命令")]),t._v(" "),s("ul",[s("li",[t._v("在 linux 操作系统上默认 /bin/sh -c")]),t._v(" "),s("li",[t._v("在 windows 操作系统上默认 cmd /S/C"),s("br"),t._v("\n 第二种是类似于函数调用。")])]),t._v(" "),s("p",[t._v("可将 executable 理解成为可执行文件，后面就是两个参数。")]),t._v(" "),s("p",[s("a",{attrs:{id:"CMD"}},[t._v("CMD")]),s("br"),t._v("\n功能为容器启动时默认命令或参数")]),t._v(" "),s("p",[t._v("语法有三种写法")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("\nCMD "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"executable"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param1"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nCMD "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param1"')]),t._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nCMD "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" param1 param2\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("第三种比较好理解了，就时 shell 这种执行方式和写法")]),t._v(" "),s("p",[t._v("第一种和第二种其实都是可执行文件加上参数的形式")]),t._v(" "),s("p",[t._v("举例说明两种写法：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("CMD "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"sh"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-c"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"echo '),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$HOME")]),t._v('"')]),t._v(" \nCMD "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"echo"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"'),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("$HOME")]),t._v('"')]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v('补充细节：这里边包括参数的一定要用双引号，就是 ", 不能是单引号。千万不能写成单引号。')]),t._v(" "),s("p",[t._v("原因是参数传递后，docker 解析的是一个 JSON array")]),t._v(" "),s("p",[s("a",{attrs:{id:"RUN&&CMD"}},[t._v("RUN&&CMD")])]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#不要把RUN和CMD搞混了。")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#RUN是构件容器时就运行的命令以及提交运行结果")]),t._v("\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#CMD是容器启动时执行的命令，在构件时并不运行，构件时紧紧指定了这个命令到底是个什么样子")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br")])]),s("p",[s("a",{attrs:{id:"ENTRYPOINT"}},[t._v("ENTRYPOINT")]),s("br"),t._v("\n功能是：容器启动时运行得启动命令")]),t._v(" "),s("p",[t._v("语法如下：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v(" ENTRYPOINT "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"executable"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param1"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"param2"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("  \n ENTRYPOINT "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v(" param1 param2\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("如果从上到下看到这里的话，那么你应该对这两种语法很熟悉啦。")]),t._v(" "),s("ul",[s("li",[t._v("第二种就是写 shell (shell 执行)")]),t._v(" "),s("li"),t._v(" "),s("li",[t._v("第一种就是可执行文件加参数（EXEC 调用，可在 docker run 启动时传递参数）")])]),t._v(" "),s("p",[t._v("与 CMD 比较说明（这俩命令太像了，而且还可以配合使用）：")]),t._v(" "),s("p",[t._v("相同点：")]),t._v(" "),s("ul",[s("li",[t._v("只能写一条，如果写了多条，那么只有最后一条生效"),s("br"),t._v("\n容器启动时才运行，运行时机相同")])]),t._v(" "),s("p",[t._v("不同点：")]),t._v(" "),s("ul",[s("li",[t._v("ENTRYPOINT 不会被运行的 command 覆盖，而 CMD 则会被覆盖")]),t._v(" "),s("li"),t._v(" "),s("li",[t._v("如果我们在 Dockerfile 种同时写了 ENTRYPOINT 和 CMD，并且 CMD 指令不是一个完整的可执行命令，那么 CMD 指定的内容将会作为 ENTRYPOINT 的参数")]),t._v(" "),s("li")]),t._v(" "),s("p",[t._v("如下：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("FROM ubuntu\nENTRYPOINT "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"top"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-b"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nCMD "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-c"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("如果我们在 Dockerfile 种同时写了 ENTRYPOINT 和 CMD，并且 CMD 是一个完整的指令，那么它们两个会互相覆盖，谁在最后谁生效")]),t._v(" "),s("p",[t._v("如下：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("FROM ubuntu\nENTRYPOINT "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"top"')]),t._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"-b"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nCMD "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" -al\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("那么将执行 ls -al ,top -b 不会执行。")]),t._v(" "),s("p",[t._v("Docker 官方使用一张表格来展示了 ENTRYPOINT 和"),s("br"),t._v("\n CMD 不同组合的执行情况"),s("br"),t._v(" "),s("img",{attrs:{src:"/assets/images/docker/02.docker%E7%9F%A5%E8%AF%86%E5%BA%93/01.Dockerfile/01.Dockerfile%E8%AF%A6%E8%A7%A3%E8%B6%85%E5%85%A8-1.jpg",alt:"images"}})]),t._v(" "),s("p",[s("a",{attrs:{id:"VOLUME"}},[t._v("VOLUME")]),s("br"),t._v("\n可实现挂载功能，可以将宿主机目录挂载到容器中")]),t._v(" "),s("p",[t._v("说的这里大家都懂了，可用专用的文件存储当作 Docker 容器的数据存储部分")]),t._v(" "),s("p",[t._v("语法如下：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("VOLUME "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/data"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("说明：")]),t._v(" "),s("p",[t._v("[“/data”] 可以是一个 JsonArray ，也可以是多个值。所以如下几种写法都是正确的")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("VOLUME "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"/var/log/"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nVOLUME /var/log\nVOLUME /var/log /var/db\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("一般的使用场景为需要持久化存储数据时")]),t._v(" "),s("p",[t._v("容器使用的是 AUFS，这种文件系统不能持久化数据，当容器关闭后，所有的更改都会丢失。")]),t._v(" "),s("p",[t._v("所以当数据需要持久化时用这个命令。")]),t._v(" "),s("p",[s("a",{attrs:{id:"USER"}},[t._v("USER")]),s("br"),t._v("\n设置启动容器的用户，可以是用户名或 UID，所以，只有下面的两种写法是正确的")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),t._v(" daemo\n"),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("USER")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("UID")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("注意：如果设置了容器以 daemon 用户去运行，那么 RUN, CMD 和 ENTRYPOINT 都会以这个用户去运行，"),s("br"),t._v("\n 使用这个命令一定要确认容器中拥有这个用户，并且拥有足够权限")]),t._v(" "),s("p",[s("a",{attrs:{id:"WORKDIR"}},[t._v("WORKDIR")]),s("br"),t._v("\n语法：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("WORKDIR /path/to/workdir\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("设置工作目录，对 RUN,CMD,ENTRYPOINT,COPY,ADD 生效。如果不存在则会创建，也可以设置多次。")]),t._v(" "),s("p",[t._v("如：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("WORKDIR /a\nWORKDIR b\nWORKDIR c\nRUN "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br")])]),s("p",[t._v("pwd 执行的结果是 /a/b/c")]),t._v(" "),s("p",[t._v("WORKDIR 也可以解析环境变量")]),t._v(" "),s("p",[t._v("如：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("ENV DIRPATH /path\nWORKDIR "),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DIRPATH")]),t._v("/"),s("span",{pre:!0,attrs:{class:"token variable"}},[t._v("$DIRNAME")]),t._v("\nRUN "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("pwd")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br")])]),s("p",[t._v("pwd 的执行结果是 /path/$DIRNAME")]),t._v(" "),s("p",[t._v("ARG"),s("br"),t._v("\n 语法：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("ARG "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("name"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("default value"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("设置变量命令，ARG 命令定义了一个变量，在 docker build 创建镜像的时候，使用 --build-arg = 来指定参数")]),t._v(" "),s("p",[t._v("如果用户在 build 镜像时指定了一个参数没有定义在 Dockerfile 种，那么将有一个 Warning")]),t._v(" "),s("p",[t._v("提示如下：")]),t._v(" "),s("p",[t._v("[Warning] One or more build-args [foo] were not consumed.")]),t._v(" "),s("p",[t._v("我们可以定义一个或多个参数，如下：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("FROM busybox\nARG user1\nARG buildno\n\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("#也可以给参数一个默认值：")]),t._v("\n\nFROM busybox\nARG "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("user1")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("someuser\nARG "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[t._v("buildno")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br"),s("span",{staticClass:"line-number"},[t._v("3")]),s("br"),s("span",{staticClass:"line-number"},[t._v("4")]),s("br"),s("span",{staticClass:"line-number"},[t._v("5")]),s("br"),s("span",{staticClass:"line-number"},[t._v("6")]),s("br"),s("span",{staticClass:"line-number"},[t._v("7")]),s("br"),s("span",{staticClass:"line-number"},[t._v("8")]),s("br"),s("span",{staticClass:"line-number"},[t._v("9")]),s("br")])]),s("p",[t._v("…"),s("br"),t._v("\n 如果我们给了 ARG 定义的参数默认值，那么当 build 镜像时没有指定参数值，将会使用这个默认值")]),t._v(" "),s("p",[s("a",{attrs:{id:"ONBUILD"}},[t._v("ONBUILD")]),s("br"),t._v("\n语法：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("ONBUILD "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("INSTRUCTION"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("这个命令只对当前镜像的子镜像生效。")]),t._v(" "),s("p",[t._v("比如当前镜像为 A，在 Dockerfile 种添加：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("ONBUILD RUN "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("ls")]),t._v(" -al\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("ul",[s("li",[t._v("这个 ls -al 命令不会在 A 镜像构建或启动的时候执行")])]),t._v(" "),s("p",[t._v("此时有一个镜像 B 是基于 A 镜像构建的，那么这个 ls -al 命令会在 B 镜像构建的时候被执行。")]),t._v(" "),s("p",[s("a",{attrs:{id:"STOPSIGNAL"}},[t._v("STOPSIGNAL")]),s("br"),t._v("\n语法：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("STOPSIGNAL signal\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br")])]),s("p",[t._v("STOPSIGNAL 命令是的作用是当容器停止时给系统发送什么样的指令，默认是 15")]),t._v(" "),s("p",[s("a",{attrs:{id:"HEALTHCHECK"}},[t._v("HEALTHCHECK")]),s("br"),t._v("\n容器健康状况检查命令")]),t._v(" "),s("p",[t._v("语法有两种：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v(" HEALTHCHECK "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("OPTIONS"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" CMD "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("command")]),t._v("\n HEALTHCHECK NONE\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("第一个的功能是在容器内部运行一个命令来检查容器的健康状况")]),t._v(" "),s("p",[t._v("第二个的功能是在基础镜像中取消健康检查命令")]),t._v(" "),s("p",[t._v("[OPTIONS] 的选项支持以下三中选项：")]),t._v(" "),s("ul",[s("li",[t._v("–interval=DURATION 两次检查默认的时间间隔为 30 秒")]),t._v(" "),s("li",[t._v("–timeout=DURATION 健康检查命令运行超时时长，默认 30 秒")]),t._v(" "),s("li",[t._v("–retries=N 当连续失败指定次数后，则容器被认为是不健康的，状态为 unhealthy，默认次数是 3")])]),t._v(" "),s("p",[t._v("注意：")]),t._v(" "),s("p",[t._v("HEALTHCHECK 命令只能出现一次，如果出现了多次，只有最后一个生效。")]),t._v(" "),s("p",[t._v("CMD 后边的命令的返回值决定了本次健康检查是否成功，具体的返回值如下：")]),t._v(" "),s("ul",[s("li",[t._v("0: success - 表示容器是健康的")]),t._v(" "),s("li",[t._v("1: unhealthy - 表示容器已经不能工作了")]),t._v(" "),s("li",[t._v("2: reserved - 保留值")])]),t._v(" "),s("p",[t._v("例子：")]),t._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[t._v("HEALTHCHECK --interval"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("5m --timeout"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("3s "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("\\")]),t._v("\nCMD "),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("curl")]),t._v(" -f http://localhost/ "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("||")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[t._v("exit")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n")])]),t._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[t._v("1")]),s("br"),s("span",{staticClass:"line-number"},[t._v("2")]),s("br")])]),s("p",[t._v("健康检查命令是：curl -f http://localhost/ || exit 1"),s("br"),t._v("\n 两次检查的间隔时间是 5 秒"),s("br"),t._v("\n命令超时时间为 3 秒")])])}),[],!1,null,null,null);a.default=r.exports}}]);